<!DOCTYPE html>
<html>

<head>
	<!-- Meta -->
	<meta charset="UTF-8"/>
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
	<meta name="generator" content="Jekyll">

	<title>将Android项目发布到本地Maven仓库</title>
  <meta name="description" content="android developer">

	<!-- CSS & fonts -->
	<link rel="stylesheet" href="/css/main.css">

	<!-- RSS -->
	<link href="/atom.xml" type="application/atom+xml" rel="alternate" title="ATOM Feed" />

  <!-- Favicon -->
  <link rel="shortcut icon" type="image/png" href="img/favicon.png">

</head>


<body>
	<div id="wrap">
	  	
	  	<!-- Navigation -->
	  	<nav id="nav">
	<div id="nav-list">
		<a href="/">Home</a>

		<!-- Nav pages -->
	  
	    
	  
	    
	      <a href="/about" title="About Me">About Me</a>
	    
	  
	    
	  
	    
	  
	    
	  
	    
	  
	    
	  
	    
	  
    
    <!-- Nav links -->
	  <a href="https://github.com/fccaikai">View on Github</a>

	</div>
  
  <!-- Nav footer -->
	
	  <footer>
	
	<span>version 1.0.0</span>

</footer>
	

</nav>

    
    <!-- Icon menu -->
	  <a id="nav-menu">
	  	<div id="menu"></div>
	  </a>

      <!-- Header -->
      
        <header id="header" class="parent justify-spaceBetween">
  <div class="inner w100 relative">
    <span class="f-left">  
      <a href="/">
        <h1>
          <span>蔡凯</span> Blog
    </h1>
    </a>
    </span>
    <span id="nav-links" class="absolute right bottom">
      <!-- Nav pages -->
	    
	      
	    
	      
	        <a href="/about" title="About Me">About Me</a>
	      
	    
	      
	    
	      
	    
	      
	    
	      
	    
	      
	    
	      
	    
      
      <!-- Nav links -->
	    <a href="https://github.com/fccaikai">View on Github</a>

    </span>
  </div>
</header>
      

    <!-- Main content -->
	  <div id="container">
		  
		<main>

			<article id="post-page">
	<h2>将Android项目发布到本地Maven仓库</h2>		
	<time datetime="2017-03-03T09:58:00+08:00" class="by-line">03 Mar 2017</time>
	<div class="content">

		<h1 id="说明">说明</h1>
<p>android studio 中我们可以通过在gradle.build中添加配置来导入引用库，如：</p>
<div class="highlighter-rouge"><pre class="highlight"><code>compile 'com.kcode.github.pubutils:androidLib:0.0.1'

</code></pre>
</div>
<p>通过这个可以看出’com.kcode.github.pubutils:androidLib:0.0.1’由三部分组成，分别是Maven中的</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;project</span> <span class="na">xsi:schemaLocation=</span><span class="s">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span> <span class="na">xmlns=</span><span class="s">"http://maven.apache.org/POM/4.0.0"</span>
    <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;modelVersion&gt;</span>4.0.0<span class="nt">&lt;/modelVersion&gt;</span>
  <span class="nt">&lt;groupId&gt;</span>com.kcode.github.pubutils<span class="nt">&lt;/groupId&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>androidLib<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;version&gt;</span>0.0.1<span class="nt">&lt;/version&gt;</span>
  <span class="nt">&lt;packaging&gt;</span>aar<span class="nt">&lt;/packaging&gt;</span>
<span class="nt">&lt;/project&gt;</span>

</code></pre>
</div>
<p>groupId:唯一标识符
artifactId：类似于项目名称
version：版本号
现在我们来创建一个自己的本地库。</p>

<h2 id="第一步">第一步</h2>
<p>新建一个Android项目。在gradle.properties中添加一下信息</p>

<div class="highlighter-rouge"><pre class="highlight"><code>#包信息
GROUP_ID = com.kcode.github.pubutils

# Licence信息
PROJ_LICENCE_NAME=The Apache Software License, Version 2.0
PROJ_LICENCE_URL=http://www.apache.org/licenses/LICENSE-2.0.txt
PROJ_LICENCE_DEST=repo

</code></pre>
</div>
<p>GROUP_ID：就是刚才的groupId</p>

<p>下面的Licence信息是固定的</p>

<h2 id="第二步">第二步</h2>
<p>创建一个Libary,我命名为AndroidLib
在Libary的根目录下新建gradle.properties文件，添加</p>
<div class="highlighter-rouge"><pre class="highlight"><code>#包信息
ARTIFACTID = androidLib
LIBRARY_VERSION = 0.0.2

#Mac下地址:file:///Users/&lt;username&gt;/my/local/repo
LOCAL_REPO_URL=file:///Users/caik/my/local/repo
</code></pre>
</div>
<p>ARTIFACTID：开始说的到artifactId
LIBRARY_VERSION：版本号
LOCAL_REPO_URL：本地仓库的地址：file://+本地路径</p>

<h2 id="第三步">第三步</h2>
<p>在Library也就是刚才创建的AndroidLib下的gradle.build中添加</p>
<div class="highlighter-rouge"><pre class="highlight"><code>apply plugin: 'maven'

uploadArchives{
    repositories.mavenDeployer{
        repository(url:LOCAL_REPO_URL)
        pom.groupId = GROUP_ID
        pom.artifactId = ARTIFACTID
        pom.version = LIBRARY_VERSION
    }
}
</code></pre>
</div>
<h2 id="第四步">第四步</h2>
<p>最后在项目路径下执行：</p>
<div class="highlighter-rouge"><pre class="highlight"><code>./gradlew -p &lt;Library name&gt; clean build uploadArchives --info
</code></pre>
</div>
<p>我这里就是：</p>
<div class="highlighter-rouge"><pre class="highlight"><code>./gradlew -p androidlib clean build uploadArchives --info

</code></pre>
</div>

<p>等执行结束到刚才设置好的</p>
<div class="highlighter-rouge"><pre class="highlight"><code>LOCAL_REPO_URL=file:///Users/caik/my/local/repo
</code></pre>
</div>
<p>路径下就可以看到已经发布好的本次仓库</p>

<h2 id="第五步">第五步</h2>
<p>引用，先在最外层的gradle.build中添加本地maven库路径</p>
<div class="highlighter-rouge"><pre class="highlight"><code>// Top-level build file where you can add configuration options common to all sub-projects/modules.

buildscript {
    repositories {
        jcenter()
    }
    dependencies {
        classpath 'com.android.tools.build:gradle:2.1.0'

        // NOTE: Do not place your application dependencies here; they belong
        // in the individual module build.gradle files
    }
}

allprojects {
    repositories {
        jcenter()

        maven {
            url 'file:///Users/caik/my/local/repo/'
        }
    }
}

task clean(type: Delete) {
    delete rootProject.buildDir
}

</code></pre>
</div>

<p>就是：</p>
<div class="highlighter-rouge"><pre class="highlight"><code>maven {
            url 'file:///Users/caik/my/local/repo/'
    }
</code></pre>
</div>
<p>然后在需要引用这个库的项目的gradle.build中添加：</p>
<div class="highlighter-rouge"><pre class="highlight"><code>compile 'com.kcode.github.pubutils:androidLib:0.0.1'

</code></pre>
</div>
<p>就可以了。</p>

<p>项目GitHub地址:https://github.com/fccaikai/LocalMavenDemo</p>

		
	</div>
</article>



	  </main>
		
		  <!-- Pagination links -->
      

	  </div>
	    
	    <!-- Footer -->
	    <footer><span>@2017 - Caikai</span></footer>

	    <!-- Script -->
      <script src="/js/main.js"></script>	


	</div>
</body>
</html>
